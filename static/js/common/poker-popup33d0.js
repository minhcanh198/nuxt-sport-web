"use strict";require(["jquery","localization","balance-helper","jquery.validate"],(function(a,t,e){var o="",n=!1,r="",l=a("#currency-code").val();function u(a){"True"===isAuthenticated?(o=a,r="",c()):window.location.href="/login?ReturnUrl=/"+page}function s(){return a("#amount-form").valid()&&!1===n?(a("#submit-amount").addClass(primary_button_class),a("#submit-amount").removeClass(disabled_button_class),!0):(a("#submit-amount").removeClass(primary_button_class),a("#submit-amount").addClass(disabled_button_class),!1)}function m(){var e=t.formatCurrency(i(),l);a("#central-wallet-amount").text(e)}function i(){var a=e.wallets.find((a=>"central"===a.walletType));return null!==a.lastAmount?a.lastAmount.money:null}function c(){m(),"pokerky"===page?a("#kylc-transfer-content").text(pokerky):"pokerlc"===page?a("#kylc-transfer-content").text(pokerlc):"pokerv8"===page&&a("#kylc-transfer-content").text(pokerv8),a("#popup-modal-kylc-transfer").slideDown("slow")}function d(t){a("#popup-modal-kylc-transfer").slideUp("slow"),t&&a("#transfer-amount").val(""),k.resetForm()}function p(t,e){e?(a("#displayed-icon").addClass("check-mark-icon"),a("#displayed-icon").removeClass("error-icon"),a(".transfer-ok").removeAttr("style"),a(".transfer-error").attr("style","display:none"),a("#popup-modal-completed-body-content").html(successMessage),a("#popup-modal-kylc-completed").addClass("ok"),r=t):(a("#displayed-icon").addClass("error-icon"),a("#displayed-icon").removeClass("check-mark-icon"),a(".transfer-error").removeAttr("style"),a(".transfer-ok").attr("style","display:none"),a("#popup-modal-completed-body-content").html(t),a("#popup-modal-kylc-completed").removeClass("ok")),a("#popup-modal-kylc-completed").slideDown("slow")}function f(){a("#popup-modal-kylc-completed").hasClass("ok")?window.open(r,"width","height"):c(),a("#popup-modal-kylc-completed").slideUp("slow")}a(".game-launch").click((function(){u(a(this).data("kind-id"))})),a(".real-play-button").click((function(a){a.preventDefault(),u(0)})),a(".lobby-launch").click((function(a){a.preventDefault(),u(0)})),a("#transfer-amount").focusout((function(){s()})),a("#submit-amount").click((function(e){e.stopImmediatePropagation(),s()&&!1===n&&(n=!0,function(e){var r=document.getElementById("kylc-poker-form"),l=t.normalizeNumber(a("#transfer-amount").val());t.useComma&&(l=l.replace(",","."));a("#submit-amount").removeClass(primary_button_class),a("#submit-amount").addClass(disabled_button_class),a.ajax({url:r.action,data:{amount:l,gameID:o},dataType:"json",success:function(a){void 0!==a.LaunchUrl?(d(!0),p(a.LaunchUrl,!0)):(d(!1),p(a.Error,!1));n=!1},error:function(){d(!1),p(ajaxerror,!1),n=!1}})}())})),a(".close-modal-kylc-transfer").click((function(){a("#submit-amount").removeClass(primary_button_class),a("#submit-amount").addClass(disabled_button_class),d(!0)})),a("#transfer-amount").on("keypress",(function(t){13===t.which&&(event.preventDefault(),a("#submit-amount").trigger("click"))})),a(".close-modal-kylc-completed").click((function(){f()})),a("#submit-completed").click((function(t){t.stopImmediatePropagation(),window.open(r,"width","height"),a("#popup-modal-kylc-completed").slideUp("slow")})),a("#submit-completed-error").click((function(){f(),c()})),e.on("amountChange",(function(){m()})),a("#amount-form").on("input",(function(){var e=a("#transfer-amount").val();e=t.normalizeNumber(e),a("#transfer-amount").val(e)})),a("#amount-form").on("focus",(function(){var e=a("#transfer-amount").val();e=t.normalizeNumber(e),a("#transfer-amount").val(e)}));const v="pokerv8"===page||"pokerlc"===page?0:.01;var k=a("#amount-form").validate({onkeyup:!1,onclick:!1,rules:{TransferAmount:{required:!0,amountvalidator:""}},messages:{TransferAmount:{required:amount_required,amountvalidator:amount_invalidamount}}});a.validator.addMethod("amountvalidator",(function(){a("#transfer-amount").rules("add",{messages:{amountvalidator:amount_invalidamount}});let e=t.normalizeNumber(a("#transfer-amount").val());if(v>Number(e))return a.validator.messages.amountvalidator=amount_invalidamount_min_value,a("#transfer-amount").rules("add",{messages:{amountvalidator:amount_invalidamount_min_value}}),!1;if(Number(e)>1e7)return a.validator.messages.amountvalidator=amount_invalidamount_max_value,a("#transfer-amount").rules("add",{messages:{amountvalidator:amount_invalidamount_max_value}}),!1;if(Number(e)>Number(i()))return a.validator.messages.amountvalidator=amount_invalidamount_over_wallet,a("#transfer-amount").rules("add",{messages:{amountvalidator:amount_invalidamount_over_wallet}}),!1;t.useComma&&(e=e.replace(",","."));const o=e.split(".");if("pokerv8"===page||"pokerlc"===page){if(o.length>1)return a.validator.messages.amountvalidator=amount_invalidamount_decimal_value,a("#transfer-amount").rules("add",{messages:{amountvalidator:amount_invalidamount_decimal_value}}),!1}else if(o?.[1]?.length>2)return!1;const n="pokerv8"===page||"pokerlc"===page?t.formatNumber(e,0):t.formatNumber(e,2);return"NaN"!==n&&(a("#transfer-amount").val(n),!0)}))}));